!function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t){e.exports='<section id="content" class="loaded playback">\n    <header>\n        <a class="logo" href="/">\n            <img src="/img/gregflix.png" alt="GregFlix logo"/>\n        </a>\n        <div class="user" id="user-profile"></div>\n    </header>\n    <section id="playback-content">\n        <video id="playback-player" class="video-js" controls></video>\n    </section>\n</section>\n'},function(e,t){e.exports='<section id="content" class="loaded catalog">\n    <header>\n        <a class="logo" href="/" id="link-to-home">\n            <img src="/img/gregflix.png" alt="GregFlix logo"/>\n        </a>\n        <div class="user" id="user-profile"></div>\n    </header>\n    <section id="promoted">\n        <video id="promoted-player" muted class="hidden"></video>\n        <div id="promoted-content-poster"></div>\n        <div id="promoted-content">\n        </div>\n    </section>\n    <section id="movies">\n        <h2>Movies</h2>\n        <div id="movie-list"></div>\n        <br style="clear:left" />\n    </section>\n</section>\n'},function(e,t,i){i(4),e.exports=i(3)},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var o=i(0),n=i.n(o);const r=e=>{let t=document.createElement("div");return t.innerHTML=e,t.textContent},s=[{name:"greg",avatar:"avatar-3"}],a=[{title:"My example movie",poster:"/img/movieData/01/movie01.png",description:"This is the promo content. Wait a few seconds, it will start playing muted in the background. If you click watch now, it'll open the player and continue playing",promoted:!0,src:"https://s3.amazonaws.com/_bc_dml/example-content/sintel_dash/sintel_vod.mpd",srcType:"application/dash+xml",type:"movie"},{title:"Parkour",poster:"/img/movieData/02/movie02.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae imperdiet libero, semper rutrum mi. Suspendisse elementum odio ornare suscipit semper. ",promoted:!1,src:"https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8",srcType:"application/x-mpegURL",type:"movie"},{title:"My third movie",poster:"/img/movieData/01/movie01.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae imperdiet libero, semper rutrum mi. Suspendisse elementum odio ornare suscipit semper. ",promoted:!1,src:"https://livesim.dashif.org/livesim/chunkdur_1/ato_7/testpic4_8s/Manifest.mpd",srcType:"application/dash+xml",type:"movie"},{title:"My fourth movie",poster:"/img/movieData/01/movie01.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae imperdiet libero, semper rutrum mi. Suspendisse elementum odio ornare suscipit semper. ",promoted:!1,src:"https://dash.akamaized.net/dash264/TestCasesUHD/2b/11/MultiRate.mpd",srcType:"application/dash+xml",type:"movie"},{title:"Big Buck Bunny",poster:"/img/movieData/01/movie01.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae imperdiet libero, semper rutrum mi. Suspendisse elementum odio ornare suscipit semper. ",promoted:!1,src:"http://184.72.239.149/vod/smil:BigBuckBunny.smil/playlist.m3u8",srcType:"application/x-mpegURL",type:"movie"},{title:"My last movie",poster:"/img/movieData/01/movie01.png",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae imperdiet libero, semper rutrum mi. Suspendisse elementum odio ornare suscipit semper. ",promoted:!1,src:"http://www.streambox.fr/playlists/test_001/stream.m3u8",srcType:"application/x-mpegURL",type:"movie"}];class l{static createAvatar(e){const t=document.createElement("div");return t.className="avatar "+e.avatar,t.innerHTML=r(e.name),t}static run(e){this.usersContainer=document.getElementById("select-user"),this.usersContainer.innerHTML="",new Promise((e,t)=>{e(s)}).then(t=>{t.map(t=>{const i=l.createAvatar(t);this.usersContainer.appendChild(i),i.onclick=()=>{localStorage.setItem("gregflix-user",JSON.stringify(t)),e.runCatalog()}})},()=>{}),l.displayAddButton(e)}static displayAddButton(e){const t=document.createElement("button");t.innerHTML="+",t.className="add-profile",t.onclick=()=>{const t=document.getElementById("user-form");document.getElementById("add-user").onclick=i=>{i.preventDefault();const o=new FormData(document.querySelector("#user-input"));let n={};for(const e of o.entries())n[e[0]]=e[1];var a;(a=n,new Promise(e=>{let t={};t.name=r(a.name),t.email=r(a.email),t.avatar=r(a.avatar||"avatar-1"),s.push(t),e()})).then(()=>{t.classList.remove("visible"),e.runHomePage()},()=>{document.getElementById("form-error").classList.remove("hidden")})},t.classList.toggle("visible")},this.usersContainer.appendChild(t)}static logOut(){localStorage.removeItem("gregflix-user")}}var c=i(1),m=i.n(c);class d{run(e){this.app=e,e.container.innerHTML=m.a,document.getElementById("link-to-home").onclick=()=>{l.logOut()},new Promise(e=>{e(a)}).then(e=>{this.showPromoted(e),this.showMovies(e)},()=>{})}showPromoted(e){let t=e.find(e=>e.promoted);if(t){this.poster=document.getElementById("promoted-content-poster"),this.poster&&(this.poster.style["background-image"]=`url(${t.poster})`);const e=document.getElementById("promoted-content");e&&(e.innerHTML=`<header>\n                    <h1>${r(t.title)}</h1>\n                    <p>${r(t.description)}</p>\n                    <button id="promo-watch-now">Watch now</button>\n                </header>`,this.loadPlayer(t),this.bindWatchEvent(t))}}showMovies(e){const t=document.getElementById("movie-list");for(let i of e.filter(e=>"movie"===e.type)){let e=`<div class="movie">\n                <img src="${i.poster}" alt="" />\n                <div class="movie-info">\n                    <h3>${r(i.title)}</h3>\n                    <p>${r(i.description)}</p>\n                  </div>\n            </div>`,o=document.createElement("div");o.innerHTML=e,o.onclick=()=>{this.app.runMovie(i)},t.appendChild(o)}}loadPlayer(e){"string"==typeof e.src&&"string"==typeof e.srcType&&(this.player=videojs("promoted-player"),this.player.src({src:e.src,type:e.srcType}),this.player.play(),this.player.on("timeupdate",()=>{this.player.currentTime()>1&&(this.player.el().classList.remove("hidden"),this.poster&&(this.poster.style.opacity="0"))}))}bindWatchEvent(e){document.getElementById("promo-watch-now").onclick=()=>{e.player=this.player,this.app.runMovie(e)}}}new class{constructor(e){this.container=document.getElementById(e),this.setUp()}setUp(){"complete"===document.readyState?this.start():window.addEventListener("load",()=>{this.start()})}runHomePage(){l.run(this)}runCatalog(){(new d).run(this)}runMovie(e){this.container.innerHTML=n.a;let t=videojs("playback-player",{fill:!0});t.src({src:e.src,type:e.srcType}),t.play(),e.player&&t.currentTime(e.player.currentTime())}start(){document.getElementById("content").classList.add("loaded"),localStorage.getItem("gregflix-user")?this.runCatalog():this.runHomePage()}}("gregflix")}]);